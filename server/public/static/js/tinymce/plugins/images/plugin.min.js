tinymce.PluginManager.add('images', function(editor) {
    // 自定义SVG图标库
    editor.ui.registry.getAll().icons.axupimgs || editor.ui.registry.addIcon('images','<svg t="1640836171130" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1339" width="24" height="24"><path d="M812.009375 362.009375C812.009375 320.75 778.259375 287 737 287s-75.009375 33.75-75.009375 75.009375 33.75 75.009375 75.009375 75.00937501 75.009375-33.75 75.009375-75.00937501z" p-id="1340"></path><path d="M62 137.009375v750.00937499h450v-75.00937499H137.009375V714.50000001l225-225.00000002L512 639.490625l52.509375-52.50937501-202.5-202.49999998-225 224.99999998V211.990625h750.00937499v225L962.028125 512V137.009375z" p-id="1341"></path><path d="M898.240625 725.75l52.509375-52.509375-176.259375-176.25937501-176.25937501 176.25937501 52.50937501 52.509375L737 639.490625v172.49062499h75.009375v-172.49062499zM587.009375 886.990625h75.00937501V962h-75.00937501v-75.009375zM737 886.990625h75.009375V962H737v-75.009375zM886.990625 886.990625H962V962h-75.009375v-75.009375z" p-id="1342"></path></svg>');
	
    // 批量上传处理事件
    var batchUpload = function () {
        return  tinymce.settings.batch_upload_callback(function (urls) {
            var html = '';
            urls.forEach(url => {
                html += '<img src="' + url +'" />';
            });
            editor.insertContent(html);
        })
    };
    
    // 注册工具栏按钮
    editor.ui.registry.addButton('images', {
        icon: 'images',
        tooltip: '批量上传', 
        onAction: function () {
            batchUpload();
        }
    });
  
    // 注册菜单项按钮
    editor.ui.registry.addMenuItem('images', {
        icon: 'images',
        text: '批量上传',
        onAction: function() {
            batchUpload();
        }
    });
    
    //插件版权信息注册
    return {
        getMetadata: function () {
            return  {
                name: "Batch Upload Images plugin",
                url: "http://www.waitshop.cn",
            };
        }
    };
});
  
  