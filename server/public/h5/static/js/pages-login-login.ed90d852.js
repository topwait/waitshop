(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-login-login"],{"082e":function(e,t,i){var n=i("24fb");t=n(!1),t.push([e.i,'@charset "UTF-8";\r\n/**\r\n * 这里是uni-app内置的常用样式变量\r\n *\r\n * uni-app 官方扩展插件及插件市场（https://ext.dcloud.net.cn）上很多三方插件均使用了这些样式变量\r\n * 如果你是插件开发者，建议你使用scss预处理，并在插件代码中直接使用这些变量（无需 import 这个文件），方便用户通过搭积木的方式开发整体风格一致的App\r\n *\r\n */\r\n/* 颜色 */\r\n/* 边框 */\r\n/* 引入Uview */uni-page-body[data-v-644e26d4]{background-color:#fff}.button-item[data-v-644e26d4]{display:flex;justify-content:center;align-items:center;font-size:%?28?%;color:#fff;width:%?580?%;height:%?86?%;border-radius:%?50?%}.button-item--mnp[data-v-644e26d4]{margin-top:%?60?%;border:1px solid #01d171;background-color:#01d171}.button-item--cancel[data-v-644e26d4]{margin-top:%?30?%;color:#999;border:1px solid #999;background-color:#fff}.button-item--mobile[data-v-644e26d4]{width:100%;margin-top:%?60?%;background-color:#ff5058}.index-mnp-widget[data-v-644e26d4]{display:flex;flex-direction:column;align-items:center;margin-top:%?200?%}.index-mnp-widget .avatar[data-v-644e26d4]{width:%?120?%;height:%?120?%;border-radius:50%;border:1px solid #eee;overflow:hidden;background-color:#eee}.index-mobile-widget[data-v-644e26d4]{margin:0 %?40?%}.index-mobile-widget .logo[data-v-644e26d4]{text-align:center;margin:%?60?% 0}.index-mobile-widget .other[data-v-644e26d4]{margin-top:%?100?%;display:flex;flex-direction:column;align-items:center;justify-content:center}.index-mobile-widget .other .header[data-v-644e26d4]{display:flex;align-items:center}.index-mobile-widget .other .header .line[data-v-644e26d4]{width:%?180?%;border-bottom:1px solid #f2f2f2}.index-mobile-widget .other .header .title[data-v-644e26d4]{padding:0 %?20?%;font-size:%?26?%;color:#999}.index-agreement-widget[data-v-644e26d4]{position:absolute;bottom:%?40?%;width:100%;text-align:center;font-size:%?24?%;color:#666}.index-agreement-widget .u-checkbox__label[data-v-644e26d4]{margin-right:0!important}body.?%PAGE?%[data-v-644e26d4]{background-color:#fff}',""]),e.exports=t},"39e7":function(e,t,i){"use strict";var n=i("8787"),o=i.n(n);o.a},4874:function(e,t,i){"use strict";i.d(t,"b",(function(){return o})),i.d(t,"c",(function(){return a})),i.d(t,"a",(function(){return n}));var n={uForm:i("8782").default,uFormItem:i("eb61").default,uInput:i("1fb0").default,uVerificationCode:i("9974").default,uButton:i("63fe").default,uCheckbox:i("74d2").default},o=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-uni-view",{staticClass:"container"},[e.isWeixin?i("v-uni-view",{staticClass:"index-mnp-widget"},[i("v-uni-view",{staticClass:"avatar"},[i("v-uni-open-data",{attrs:{type:"userAvatarUrl"}})],1),i("v-uni-view",{staticClass:"u-font-28 u-margin-top-10"},[e._v("用户昵称")]),i("v-uni-view",{staticClass:"u-font-28 u-margin-top-30"},[e._v("申请获取以下权限")]),i("v-uni-view",{staticClass:"u-font-22 u-margin-top-20 u-color-muted"},[e._v("获得你的公开信息（昵称、头像等）")]),e.isBindMobile?[i("v-uni-view",{staticClass:"u-flex u-margin-top-50"},[i("v-uni-view",{staticClass:"button-item button-item--cancel",staticStyle:{width:"270rpx","margin-top":"0"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.onCancelLogin.apply(void 0,arguments)}}},[e._v("暂不登录")]),i("v-uni-button",{staticClass:"button-item button-item--mnp",staticStyle:{width:"270rpx","margin-top":"0","margin-left":"30rpx"},attrs:{"open-type":"getPhoneNumber"},on:{getphonenumber:function(t){arguments[0]=t=e.$handleEvent(t),e.getPhoneNumber.apply(void 0,arguments)}}},[i("v-uni-text",[e._v("微信登录")])],1)],1)]:[i("v-uni-view",{staticClass:"button-item button-item--mnp",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.onWxLogin.apply(void 0,arguments)}}},[i("v-uni-image",{staticClass:"u-equal-50 u-margin-right-10",attrs:{src:"/static/ic_share_wechat.png"}}),i("v-uni-text",[e._v("微信一键授权")])],1),i("v-uni-view",{staticClass:"button-item button-item--cancel",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.onCancelLogin.apply(void 0,arguments)}}},[e._v("暂不登录")])]],2):e._e(),e.isWeixin?e._e():i("v-uni-view",{staticClass:"index-mobile-widget"},[i("v-uni-view",{staticClass:"logo"},[i("v-uni-image",{staticStyle:{width:"560rpx",height:"156rpx"},attrs:{src:e.config.login_logo}})],1),i("u-form",{ref:"uForm",attrs:{model:e.form}},[i("u-form-item",[i("u-input",{attrs:{type:"number",placeholder:"请输入手机号"},model:{value:e.form.mobile,callback:function(t){e.$set(e.form,"mobile",t)},expression:"form.mobile"}})],1),2===e.loginType?i("u-form-item",[i("u-input",{attrs:{type:"number",placeholder:"请输入验证码"},model:{value:e.form.code,callback:function(t){e.$set(e.form,"code",t)},expression:"form.code"}}),i("u-form-item",{attrs:{slot:"right","border-bottom":!1},slot:"right"},[i("u-verification-code",{ref:"uCode",attrs:{seconds:e.seconds},on:{change:function(t){arguments[0]=t=e.$handleEvent(t),e.onChangeSms.apply(void 0,arguments)}}}),i("u-button",{attrs:{plain:!0,type:"error","hover-class":"none",size:"mini",shape:"circle"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.onSendSms.apply(void 0,arguments)}}},[e._v(e._s(e.smsTips))])],1)],1):e._e(),1===e.loginType?i("u-form-item",[i("u-input",{attrs:{type:"password",placeholder:"请输入密码"},model:{value:e.form.password,callback:function(t){e.$set(e.form,"password",t)},expression:"form.password"}})],1):e._e()],1),i("v-uni-view",{staticClass:"button-item button-item--mobile",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.onMobileLogin.apply(void 0,arguments)}}},[e._v("登录")]),i("v-uni-view",{staticClass:"u-flex u-row-between u-margin-tb-40"},[this.config.login_way&&this.config.login_way.length>=2?i("v-uni-view",{staticClass:"u-font-28 u-color-lighter",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.onSwitchLoginType.apply(void 0,arguments)}}},[e._v(e._s(0==e.loginType?"账号密码登录":"短信验证码登录"))]):i("v-uni-view"),i("v-uni-view",{staticClass:"u-font-28 u-color-lighter",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.$toPage("/pages/register/register")}}},[e._v("注册账号")])],1),e.isWeixin?i("v-uni-view",{staticClass:"other"},[i("v-uni-view",{staticClass:"header"},[i("v-uni-view",{staticClass:"line"}),i("v-uni-view",{staticClass:"title"},[e._v("其他登录方式")]),i("v-uni-view",{staticClass:"line"})],1),i("v-uni-view",{staticClass:"u-margin-tb-40"},[i("v-uni-view",{staticClass:"wx",staticStyle:{"text-align":"center"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.onWxLogin.apply(void 0,arguments)}}},[i("v-uni-image",{staticClass:"u-equal-80 u-margin-right-10",attrs:{src:"/static/ic_share_wechat.png"}}),i("v-uni-view",{staticClass:"u-font-26 u-color-normal u-margin-top-10"},[e._v("微信登录")])],1)],1)],1):e._e()],1),i("v-uni-view",{staticClass:"index-agreement-widget"},[i("v-uni-view",{staticClass:"login-text"},[i("u-checkbox",{attrs:{"active-color":"#FF5058"},on:{change:function(t){arguments[0]=t=e.$handleEvent(t),e.onCheckboxChange.apply(void 0,arguments)}},model:{value:e.isAgree,callback:function(t){e.isAgree=t},expression:"isAgree"}}),i("v-uni-text",[e._v("已阅读并同意WaitShop")]),i("v-uni-text",{staticStyle:{color:"#FF2C3C"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.$toPage("/bundle/pages/user_policy/user_policy?type=service")}}},[e._v("《服务协议》")]),i("v-uni-text",[e._v("和")]),i("v-uni-text",{staticStyle:{color:"#FF2C3C"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.$toPage("/bundle/pages/user_policy/user_policy?type=privacy")}}},[e._v("《隐私协议》")])],1)],1)],1)},a=[]},8787:function(e,t,i){var n=i("082e");"string"===typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);var o=i("4f06").default;o("51db009a",n,!0,{sourceMap:!1,shadowMode:!1})},c0d2:function(e,t,i){"use strict";i.r(t);var n=i("4874"),o=i("f152");for(var a in o)"default"!==a&&function(e){i.d(t,e,(function(){return o[e]}))}(a);i("39e7");var r,s=i("f0c5"),u=Object(s["a"])(o["default"],n["b"],n["c"],!1,null,"644e26d4",null,!1,n["a"],r);t["default"]=u.exports},d6bc:function(e,t,i){"use strict";var n=i("4ea4");i("26e9"),i("e25e"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,i("96cf");var o=n(i("1da1")),a=n(i("5530")),r=i("ada8"),s=i("26cb"),u={data:function(){return{isBindMobile:!1,loginType:2,config:[],isWeixin:!0,isAgree:!1,smsTips:"",seconds:60,userInfo:null,wxCode:null,mobile:"",form:{mobile:"",code:"",password:""}}},onLoad:function(){this.isLogin&&uni.reLaunch({url:"/pages/index/index"}),this.getConfigFun(),this.isWeixin=(0,r.isWeixin)()},computed:(0,a.default)({},(0,s.mapState)(["isLogin"])),methods:(0,a.default)((0,a.default)({},(0,s.mapMutations)(["LOGIN"])),{},{getConfigFun:function(){var e=this;return(0,o.default)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.$u.api.apiLoginConfig().then((function(t){0===t.code?(e.config=t.data,e.config.login_way.length>0&&(e.config.login_way=e.config.login_way.reverse(),e.loginType=parseInt(e.config.login_way[0]))):e.$showToast("loading config error")}));case 1:case"end":return t.stop()}}),t)})))()},getPhoneNumber:function(e){var t=this;return(0,o.default)(regeneratorRuntime.mark((function i(){var n;return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:if("getPhoneNumber:ok"===e.detail.errMsg){i.next=3;break}return t.$showToast(e.detail.errMsg),i.abrupt("return");case 3:return uni.showLoading({title:"登录中...",mask:!0}),i.next=6,(0,r.getWxCode)();case 6:i.sent,n={encryptedData:e.detail.encryptedData,iv:e.detail.iv,code:t.wxCode,scene:"mnp",client:(0,r.isClient)(),avatarUrl:t.userInfo.avatarUrl,nickName:t.userInfo.nickName,gender:t.userInfo.gender},t.$u.api.apiLogin(n).then((function(e){0===e.code?(t.LOGIN(e.data),uni.hideLoading(),"pages/login/login"!==(0,r.currentPage)().route?uni.navigateBack({delta:1}):uni.reLaunch({url:"/pages/index/index"})):t.$showToast(e.msg)}));case 9:case"end":return i.stop()}}),i)})))()},onCancelLogin:function(){uni.navigateBack({})},onSwitchLoginType:function(){this.loginType=1===this.loginType?2:1},onWxLogin:function(){var e=this;return(0,o.default)(regeneratorRuntime.mark((function t(){var i,n,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.isAgree){t.next=2;break}return t.abrupt("return",e.$showToast("请阅读服务协议并同意"));case 2:if(6===(0,r.isClient)()){t.next=4;break}return t.abrupt("return",e.$showToast("非微信环境禁止操作"));case 4:if(e.userInfo){t.next=10;break}return t.next=7,(0,r.getUserProfile)();case 7:i=t.sent,e.userInfo=i.userInfo,e.isBindMobile=0!=e.config.force_mobile;case 10:return t.next=12,(0,r.getWxCode)();case 12:n=t.sent,e.wxCode=n,0==e.config.force_mobile&&(uni.showLoading({title:"登录中...",mask:!0}),o={scene:"mnp",client:(0,r.isClient)(),code:e.wxCode,avatarUrl:e.userInfo.avatarUrl,nickName:e.userInfo.nickName,gender:e.userInfo.gender},e.$u.api.apiLogin(o).then((function(t){0===t.code?(e.LOGIN(t.data),uni.hideLoading(),"pages/login/login"!==(0,r.currentPage)().route?uni.navigateBack({delta:1}):uni.reLaunch({url:"/pages/index/index"})):e.$showToast(t.msg)})));case 15:case"end":return t.stop()}}),t)})))()},onMobileLogin:function(){var e=this;if(!this.isAgree)return this.$showToast("请阅读服务协议并同意");if(""==this.form.mobile)return this.$u.toast("手机号不能为空");if(11!=this.form.mobile.length)return this.$u.toast("手机号输入有误");if(2==this.loginType){if(""==this.form.code)return this.$u.toast("请输入验证码")}else{if(""==this.form.password)return this.$u.toast("登录密码不能为空");if(this.form.password.length<6)return this.$u.toast("登录密码错误");if(this.form.password.length>20)return this.$u.toast("登录密码错误")}var t={scene:2===this.loginType?"mobile":"account",client:(0,r.isClient)(),mobile:this.form.mobile,code:this.form.code,password:this.form.password};uni.showLoading({title:"登录中...",mask:!0}),this.$u.api.apiLogin(t).then((function(t){0===t.code?(e.LOGIN(t.data),uni.hideLoading(),"pages/login/login"!==(0,r.currentPage)().route?uni.navigateBack({delta:1}):uni.reLaunch({url:"/pages/index/index"})):e.$showToast(t.msg)}))},onSendSms:function(){var e=this;return""==this.form.mobile?this.$u.toast("手机号不能为空"):11!=this.form.mobile.length?this.$u.toast("手机号输入有误"):void(this.$refs.uCode.canGetCode?(uni.showLoading({title:"正在获取验证码"}),this.$u.api.apiSendSms({mobile:this.form.mobile,scene:110}).then((function(t){uni.hideLoading(),0===t.code?(e.$u.toast("验证码已发送"),e.$refs.uCode.start()):e.$u.toast(t.msg)}))):this.$u.toast("倒计时结束后再发送"))},onChangeSms:function(e){this.smsTips=e},onCheckboxChange:function(){this.isAgree=!this.isAgree}})};t.default=u},f152:function(e,t,i){"use strict";i.r(t);var n=i("d6bc"),o=i.n(n);for(var a in n)"default"!==a&&function(e){i.d(t,e,(function(){return n[e]}))}(a);t["default"]=o.a}}]);